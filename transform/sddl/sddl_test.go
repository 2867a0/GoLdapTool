package sddl

import (
	"fmt"
	"testing"
)

func TestSDDLResolve(t *testing.T) {
	testSDDL := []byte{1, 0, 20, 140, 192, 8, 0, 0, 220, 8, 0, 0, 20, 0, 0, 0,
		140, 0, 0, 0, 4, 0, 120, 0, 2, 0, 0, 0, 7, 90, 56, 0,
		32, 0, 0, 0, 3, 0, 0, 0, 190, 59, 14, 243, 240, 159, 209, 17,
		182, 3, 0, 0, 248, 3, 103, 193, 165, 122, 150, 191, 230, 13, 208, 17,
		162, 133, 0, 170, 0, 48, 73, 226, 1, 1, 0, 0, 0, 0, 0, 1,
		0, 0, 0, 0, 7, 90, 56, 0, 32, 0, 0, 0, 3, 0, 0, 0,
		191, 59, 14, 243, 240, 159, 209, 17, 182, 3, 0, 0, 248, 3, 103, 193,
		165, 122, 150, 191, 230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226,
		1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 4, 0, 52, 8,
		46, 0, 0, 0, 5, 0, 56, 0, 16, 0, 0, 0, 1, 0, 0, 0,
		0, 66, 22, 76, 192, 32, 208, 17, 167, 104, 0, 170, 0, 110, 5, 41,
		1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0, 189, 196, 43, 33,
		55, 199, 37, 127, 238, 57, 55, 71, 41, 2, 0, 0, 5, 0, 56, 0,
		16, 0, 0, 0, 1, 0, 0, 0, 16, 32, 32, 95, 165, 121, 208, 17,
		144, 32, 0, 192, 79, 194, 212, 207, 1, 5, 0, 0, 0, 0, 0, 5,
		21, 0, 0, 0, 189, 196, 43, 33, 55, 199, 37, 127, 238, 57, 55, 71,
		41, 2, 0, 0, 5, 0, 56, 0, 16, 0, 0, 0, 1, 0, 0, 0,
		64, 194, 10, 188, 169, 121, 208, 17, 144, 32, 0, 192, 79, 194, 212, 207,
		1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0, 189, 196, 43, 33,
		55, 199, 37, 127, 238, 57, 55, 71, 41, 2, 0, 0, 5, 0, 56, 0,
		16, 0, 0, 0, 1, 0, 0, 0, 248, 136, 112, 3, 225, 10, 210, 17,
		180, 34, 0, 160, 201, 104, 249, 57, 1, 5, 0, 0, 0, 0, 0, 5,
		21, 0, 0, 0, 189, 196, 43, 33, 55, 199, 37, 127, 238, 57, 55, 71,
		41, 2, 0, 0, 5, 0, 56, 0, 48, 0, 0, 0, 1, 0, 0, 0,
		127, 122, 150, 191, 230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226,
		1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0, 189, 196, 43, 33,
		55, 199, 37, 127, 238, 57, 55, 71, 5, 2, 0, 0, 5, 0, 44, 0,
		16, 0, 0, 0, 1, 0, 0, 0, 29, 177, 169, 70, 174, 96, 90, 64,
		183, 232, 255, 138, 88, 212, 86, 210, 1, 2, 0, 0, 0, 0, 0, 5,
		32, 0, 0, 0, 48, 2, 0, 0, 5, 0, 44, 0, 48, 0, 0, 0,
		1, 0, 0, 0, 28, 154, 182, 109, 34, 148, 209, 17, 174, 189, 0, 0,
		248, 3, 103, 193, 1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0,
		49, 2, 0, 0, 5, 0, 44, 0, 48, 0, 0, 0, 1, 0, 0, 0,
		98, 188, 5, 88, 201, 189, 40, 68, 165, 226, 133, 106, 15, 76, 24, 94,
		1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0, 49, 2, 0, 0,
		5, 0, 40, 0, 0, 1, 0, 0, 1, 0, 0, 0, 83, 26, 114, 171,
		47, 30, 208, 17, 152, 25, 0, 170, 0, 64, 82, 155, 1, 1, 0, 0,
		0, 0, 0, 1, 0, 0, 0, 0, 5, 0, 40, 0, 0, 1, 0, 0,
		1, 0, 0, 0, 83, 26, 114, 171, 47, 30, 208, 17, 152, 25, 0, 170,
		0, 64, 82, 155, 1, 1, 0, 0, 0, 0, 0, 5, 10, 0, 0, 0,
		5, 0, 40, 0, 0, 1, 0, 0, 1, 0, 0, 0, 84, 26, 114, 171,
		47, 30, 208, 17, 152, 25, 0, 170, 0, 64, 82, 155, 1, 1, 0, 0,
		0, 0, 0, 5, 10, 0, 0, 0, 5, 0, 40, 0, 0, 1, 0, 0,
		1, 0, 0, 0, 86, 26, 114, 171, 47, 30, 208, 17, 152, 25, 0, 170,
		0, 64, 82, 155, 1, 1, 0, 0, 0, 0, 0, 5, 10, 0, 0, 0,
		5, 0, 40, 0, 16, 0, 0, 0, 1, 0, 0, 0, 66, 47, 186, 89,
		162, 121, 208, 17, 144, 32, 0, 192, 79, 194, 211, 207, 1, 1, 0, 0,
		0, 0, 0, 5, 11, 0, 0, 0, 5, 0, 40, 0, 16, 0, 0, 0,
		1, 0, 0, 0, 84, 1, 141, 228, 248, 188, 209, 17, 135, 2, 0, 192,
		79, 185, 96, 80, 1, 1, 0, 0, 0, 0, 0, 5, 11, 0, 0, 0,
		5, 0, 40, 0, 16, 0, 0, 0, 1, 0, 0, 0, 134, 184, 181, 119,
		74, 148, 209, 17, 174, 189, 0, 0, 248, 3, 103, 193, 1, 1, 0, 0,
		0, 0, 0, 5, 11, 0, 0, 0, 5, 0, 40, 0, 16, 0, 0, 0,
		1, 0, 0, 0, 179, 149, 87, 228, 85, 148, 209, 17, 174, 189, 0, 0,
		248, 3, 103, 193, 1, 1, 0, 0, 0, 0, 0, 5, 11, 0, 0, 0,
		5, 0, 40, 0, 48, 0, 0, 0, 1, 0, 0, 0, 134, 184, 181, 119,
		74, 148, 209, 17, 174, 189, 0, 0, 248, 3, 103, 193, 1, 1, 0, 0,
		0, 0, 0, 5, 10, 0, 0, 0, 5, 0, 40, 0, 48, 0, 0, 0,
		1, 0, 0, 0, 178, 149, 87, 228, 85, 148, 209, 17, 174, 189, 0, 0,
		248, 3, 103, 193, 1, 1, 0, 0, 0, 0, 0, 5, 10, 0, 0, 0,
		5, 0, 40, 0, 48, 0, 0, 0, 1, 0, 0, 0, 179, 149, 87, 228,
		85, 148, 209, 17, 174, 189, 0, 0, 248, 3, 103, 193, 1, 1, 0, 0,
		0, 0, 0, 5, 10, 0, 0, 0, 0, 0, 36, 0, 255, 1, 15, 0,
		1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0, 189, 196, 43, 33,
		55, 199, 37, 127, 238, 57, 55, 71, 0, 2, 0, 0, 0, 0, 24, 0,
		255, 1, 15, 0, 1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0,
		36, 2, 0, 0, 0, 0, 20, 0, 0, 0, 2, 0, 1, 1, 0, 0,
		0, 0, 0, 5, 11, 0, 0, 0, 0, 0, 20, 0, 148, 0, 2, 0,
		1, 1, 0, 0, 0, 0, 0, 5, 10, 0, 0, 0, 0, 0, 20, 0,
		255, 1, 15, 0, 1, 1, 0, 0, 0, 0, 0, 5, 18, 0, 0, 0,
		5, 26, 60, 0, 16, 0, 0, 0, 3, 0, 0, 0, 0, 66, 22, 76,
		192, 32, 208, 17, 167, 104, 0, 170, 0, 110, 5, 41, 20, 204, 40, 72,
		55, 20, 188, 69, 155, 7, 173, 111, 1, 94, 95, 40, 1, 2, 0, 0,
		0, 0, 0, 5, 32, 0, 0, 0, 42, 2, 0, 0, 5, 18, 60, 0,
		16, 0, 0, 0, 3, 0, 0, 0, 0, 66, 22, 76, 192, 32, 208, 17,
		167, 104, 0, 170, 0, 110, 5, 41, 186, 122, 150, 191, 230, 13, 208, 17,
		162, 133, 0, 170, 0, 48, 73, 226, 1, 2, 0, 0, 0, 0, 0, 5,
		32, 0, 0, 0, 42, 2, 0, 0, 5, 26, 60, 0, 16, 0, 0, 0,
		3, 0, 0, 0, 16, 32, 32, 95, 165, 121, 208, 17, 144, 32, 0, 192,
		79, 194, 212, 207, 20, 204, 40, 72, 55, 20, 188, 69, 155, 7, 173, 111,
		1, 94, 95, 40, 1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0,
		42, 2, 0, 0, 5, 18, 60, 0, 16, 0, 0, 0, 3, 0, 0, 0,
		16, 32, 32, 95, 165, 121, 208, 17, 144, 32, 0, 192, 79, 194, 212, 207,
		186, 122, 150, 191, 230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226,
		1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0, 42, 2, 0, 0,
		5, 26, 60, 0, 16, 0, 0, 0, 3, 0, 0, 0, 64, 194, 10, 188,
		169, 121, 208, 17, 144, 32, 0, 192, 79, 194, 212, 207, 20, 204, 40, 72,
		55, 20, 188, 69, 155, 7, 173, 111, 1, 94, 95, 40, 1, 2, 0, 0,
		0, 0, 0, 5, 32, 0, 0, 0, 42, 2, 0, 0, 5, 18, 60, 0,
		16, 0, 0, 0, 3, 0, 0, 0, 64, 194, 10, 188, 169, 121, 208, 17,
		144, 32, 0, 192, 79, 194, 212, 207, 186, 122, 150, 191, 230, 13, 208, 17,
		162, 133, 0, 170, 0, 48, 73, 226, 1, 2, 0, 0, 0, 0, 0, 5,
		32, 0, 0, 0, 42, 2, 0, 0, 5, 26, 60, 0, 16, 0, 0, 0,
		3, 0, 0, 0, 66, 47, 186, 89, 162, 121, 208, 17, 144, 32, 0, 192,
		79, 194, 211, 207, 20, 204, 40, 72, 55, 20, 188, 69, 155, 7, 173, 111,
		1, 94, 95, 40, 1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0,
		42, 2, 0, 0, 5, 18, 60, 0, 16, 0, 0, 0, 3, 0, 0, 0,
		66, 47, 186, 89, 162, 121, 208, 17, 144, 32, 0, 192, 79, 194, 211, 207,
		186, 122, 150, 191, 230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226,
		1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0, 42, 2, 0, 0,
		5, 26, 60, 0, 16, 0, 0, 0, 3, 0, 0, 0, 248, 136, 112, 3,
		225, 10, 210, 17, 180, 34, 0, 160, 201, 104, 249, 57, 20, 204, 40, 72,
		55, 20, 188, 69, 155, 7, 173, 111, 1, 94, 95, 40, 1, 2, 0, 0,
		0, 0, 0, 5, 32, 0, 0, 0, 42, 2, 0, 0, 5, 18, 60, 0,
		16, 0, 0, 0, 3, 0, 0, 0, 248, 136, 112, 3, 225, 10, 210, 17,
		180, 34, 0, 160, 201, 104, 249, 57, 186, 122, 150, 191, 230, 13, 208, 17,
		162, 133, 0, 170, 0, 48, 73, 226, 1, 2, 0, 0, 0, 0, 0, 5,
		32, 0, 0, 0, 42, 2, 0, 0, 5, 26, 56, 0, 16, 0, 0, 0,
		3, 0, 0, 0, 109, 158, 198, 183, 199, 44, 210, 17, 133, 78, 0, 160,
		201, 131, 246, 8, 134, 122, 150, 191, 230, 13, 208, 17, 162, 133, 0, 170,
		0, 48, 73, 226, 1, 1, 0, 0, 0, 0, 0, 5, 9, 0, 0, 0,
		5, 26, 56, 0, 16, 0, 0, 0, 3, 0, 0, 0, 109, 158, 198, 183,
		199, 44, 210, 17, 133, 78, 0, 160, 201, 131, 246, 8, 156, 122, 150, 191,
		230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226, 1, 1, 0, 0,
		0, 0, 0, 5, 9, 0, 0, 0, 5, 18, 56, 0, 16, 0, 0, 0,
		3, 0, 0, 0, 109, 158, 198, 183, 199, 44, 210, 17, 133, 78, 0, 160,
		201, 131, 246, 8, 186, 122, 150, 191, 230, 13, 208, 17, 162, 133, 0, 170,
		0, 48, 73, 226, 1, 1, 0, 0, 0, 0, 0, 5, 9, 0, 0, 0,
		5, 26, 56, 0, 32, 0, 0, 0, 3, 0, 0, 0, 147, 123, 27, 234,
		72, 94, 213, 70, 188, 108, 77, 244, 253, 167, 138, 53, 134, 122, 150, 191,
		230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226, 1, 1, 0, 0,
		0, 0, 0, 5, 10, 0, 0, 0, 5, 26, 44, 0, 148, 0, 2, 0,
		2, 0, 0, 0, 20, 204, 40, 72, 55, 20, 188, 69, 155, 7, 173, 111,
		1, 94, 95, 40, 1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0,
		42, 2, 0, 0, 5, 26, 44, 0, 148, 0, 2, 0, 2, 0, 0, 0,
		156, 122, 150, 191, 230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226,
		1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0, 42, 2, 0, 0,
		5, 18, 44, 0, 148, 0, 2, 0, 2, 0, 0, 0, 186, 122, 150, 191,
		230, 13, 208, 17, 162, 133, 0, 170, 0, 48, 73, 226, 1, 2, 0, 0,
		0, 0, 0, 5, 32, 0, 0, 0, 42, 2, 0, 0, 5, 19, 40, 0,
		48, 0, 0, 0, 1, 0, 0, 0, 229, 195, 120, 63, 154, 247, 189, 70,
		160, 184, 157, 24, 17, 109, 220, 121, 1, 1, 0, 0, 0, 0, 0, 5,
		10, 0, 0, 0, 5, 18, 40, 0, 48, 1, 0, 0, 1, 0, 0, 0,
		222, 71, 230, 145, 111, 217, 112, 75, 149, 87, 214, 63, 244, 243, 204, 216,
		1, 1, 0, 0, 0, 0, 0, 5, 10, 0, 0, 0, 0, 18, 36, 0,
		255, 1, 15, 0, 1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0,
		189, 196, 43, 33, 55, 199, 37, 127, 238, 57, 55, 71, 7, 2, 0, 0,
		0, 18, 24, 0, 4, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 5,
		32, 0, 0, 0, 42, 2, 0, 0, 0, 18, 24, 0, 189, 1, 15, 0,
		1, 2, 0, 0, 0, 0, 0, 5, 32, 0, 0, 0, 32, 2, 0, 0,
		1, 5, 0, 0, 0, 0, 0, 5, 21, 0, 0, 0, 189, 196, 43, 33,
		55, 199, 37, 127, 238, 57, 55, 71, 0, 2, 0, 0, 1, 5, 0, 0,
		0, 0, 0, 5, 21, 0, 0, 0, 189, 196, 43, 33, 55, 199, 37, 127,
		238, 57, 55, 71, 0, 2, 0, 0}

	_, err := NewSecurityDescriptor(testSDDL)
	if err != nil {
		fmt.Printf(err.Error())
	}
}

func TestByteToInt(t *testing.T) {
	control := []byte{20, 140}
	dd := uint16(control[0]) | uint16(control[1])<<8
	fmt.Println(dd)
}
